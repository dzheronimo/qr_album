# Print Service

–°–µ—Ä–≤–∏—Å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ PDF –∏ –ø–µ—á–∞—Ç–∏ QR –∫–æ–¥–æ–≤ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤ –∏ –º–∞–∫–µ—Ç–æ–≤.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **PDF –ì–µ–Ω–µ—Ä–∞—Ü–∏—è**: –°–æ–∑–¥–∞–Ω–∏–µ PDF –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏–∑ HTML —à–∞–±–ª–æ–Ω–æ–≤
- **QR –≠—Ç–∏–∫–µ—Ç–∫–∏**: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —ç—Ç–∏–∫–µ—Ç–æ–∫ —Å QR –∫–æ–¥–∞–º–∏
- **–®–∞–±–ª–æ–Ω—ã**: –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ HTML/CSS —à–∞–±–ª–æ–Ω—ã
- **–ú–∞–∫–µ—Ç—ã**: –ì–∏–±–∫–∏–µ –º–∞–∫–µ—Ç—ã —Å—Ç—Ä–∞–Ω–∏—Ü —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π –æ—Ç—Å—Ç—É–ø–æ–≤
- **–û—á–µ—Ä–µ–¥—å –ø–µ—á–∞—Ç–∏**: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–¥–∞–Ω–∏–π
- **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã**: PDF, PNG, JPG, SVG
- **–ö–∞—á–µ—Å—Ç–≤–æ**: –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ–µ DPI –∏ —Ä–∞–∑–º–µ—Ä—ã —Å—Ç—Ä–∞–Ω–∏—Ü

## üìã –¢–∏–ø—ã –∑–∞–¥–∞–Ω–∏–π –ø–µ—á–∞—Ç–∏

- **QR_LABEL**: –≠—Ç–∏–∫–µ—Ç–∫–∏ —Å QR –∫–æ–¥–∞–º–∏
- **ALBUM_COVER**: –û–±–ª–æ–∂–∫–∏ –∞–ª—å–±–æ–º–æ–≤
- **PAGE_THUMBNAIL**: –ú–∏–Ω–∏–∞—Ç—é—Ä—ã —Å—Ç—Ä–∞–Ω–∏—Ü
- **CUSTOM_TEMPLATE**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —à–∞–±–ª–æ–Ω—ã

## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.11+
- PostgreSQL 13+
- WeasyPrint (–¥–ª—è PDF –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏)

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

1. –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö PostgreSQL:
```sql
CREATE DATABASE print_db;
```

2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
```bash
cp env.example .env
```

3. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env` —Ñ–∞–π–ª —Å –≤–∞—à–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏

4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏:
```bash
alembic upgrade head
```

### –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞

```bash
uvicorn app.main:app --host 0.0.0.0 --port 8011 --reload
```

## üìö API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É:
- Swagger UI: http://localhost:8011/docs
- ReDoc: http://localhost:8011/redoc

## üîß –û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### –ü–µ—á–∞—Ç—å
- `POST /api/v1/print/jobs` - –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è –ø–µ—á–∞—Ç–∏
- `GET /api/v1/print/jobs` - –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `GET /api/v1/print/jobs/{id}` - –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è –ø–æ ID
- `POST /api/v1/print/jobs/{id}/process` - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–¥–∞–Ω–∏—è
- `GET /api/v1/print/jobs/{id}/download` - –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
- `GET /api/v1/print/stats` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–µ—á–∞—Ç–∏

### –®–∞–±–ª–æ–Ω—ã
- `POST /api/v1/templates` - –°–æ–∑–¥–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞
- `GET /api/v1/templates` - –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —à–∞–±–ª–æ–Ω–æ–≤
- `GET /api/v1/templates/active` - –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤
- `GET /api/v1/templates/{id}` - –ü–æ–ª—É—á–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞ –ø–æ ID
- `PUT /api/v1/templates/{id}` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞
- `DELETE /api/v1/templates/{id}` - –£–¥–∞–ª–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞
- `POST /api/v1/templates/{id}/toggle` - –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
- `POST /api/v1/templates/{id}/validate` - –í–∞–ª–∏–¥–∞—Ü–∏—è —à–∞–±–ª–æ–Ω–∞

### –ú–∞–∫–µ—Ç—ã
- `POST /api/v1/layouts` - –°–æ–∑–¥–∞–Ω–∏–µ –º–∞–∫–µ—Ç–∞
- `GET /api/v1/layouts` - –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –º–∞–∫–µ—Ç–æ–≤
- `GET /api/v1/layouts/active` - –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö –º–∞–∫–µ—Ç–æ–≤
- `GET /api/v1/layouts/{id}` - –ü–æ–ª—É—á–µ–Ω–∏–µ –º–∞–∫–µ—Ç–∞ –ø–æ ID
- `PUT /api/v1/layouts/{id}` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞–∫–µ—Ç–∞
- `DELETE /api/v1/layouts/{id}` - –£–¥–∞–ª–µ–Ω–∏–µ –º–∞–∫–µ—Ç–∞
- `POST /api/v1/layouts/{id}/toggle` - –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
- `POST /api/v1/layouts/{id}/validate` - –í–∞–ª–∏–¥–∞—Ü–∏—è –º–∞–∫–µ—Ç–∞

### –û—á–µ—Ä–µ–¥—å
- `GET /api/v1/queue/status` - –°—Ç–∞—Ç—É—Å –æ—á–µ—Ä–µ–¥–∏
- `GET /api/v1/queue/items` - –≠–ª–µ–º–µ–Ω—Ç—ã –æ—á–µ—Ä–µ–¥–∏
- `POST /api/v1/queue/next` - –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è
- `POST /api/v1/queue/jobs/{id}/complete` - –û—Ç–º–µ—Ç–∫–∞ –∫–∞–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω–æ–≥–æ
- `POST /api/v1/queue/jobs/{id}/failed` - –û—Ç–º–µ—Ç–∫–∞ –∫–∞–∫ –Ω–µ—É–¥–∞—á–Ω–æ–≥–æ
- `POST /api/v1/queue/jobs/{id}/reschedule` - –ü–µ—Ä–µ–Ω–æ—Å –∑–∞–¥–∞–Ω–∏—è
- `POST /api/v1/queue/jobs/{id}/priority` - –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞

## üóÑÔ∏è –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

### PrintJob
- `id`: –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- `user_id`: ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `job_type`: –¢–∏–ø –∑–∞–¥–∞–Ω–∏—è –ø–µ—á–∞—Ç–∏
- `template_id`: ID —à–∞–±–ª–æ–Ω–∞
- `layout_id`: ID –º–∞–∫–µ—Ç–∞
- `content_data`: –î–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- `print_format`: –§–æ—Ä–º–∞—Ç –ø–µ—á–∞—Ç–∏
- `status`: –°—Ç–∞—Ç—É—Å –∑–∞–¥–∞–Ω–∏—è
- `output_file_path`: –ü—É—Ç—å –∫ –≤—ã—Ö–æ–¥–Ω–æ–º—É —Ñ–∞–π–ª—É

### PrintTemplate
- `id`: –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- `name`: –ù–∞–∑–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞
- `template_type`: –¢–∏–ø —à–∞–±–ª–æ–Ω–∞
- `html_template`: HTML —à–∞–±–ª–æ–Ω
- `css_styles`: CSS —Å—Ç–∏–ª–∏
- `template_variables`: –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —à–∞–±–ª–æ–Ω–∞
- `required_fields`: –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è

### PrintLayout
- `id`: –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- `name`: –ù–∞–∑–≤–∞–Ω–∏–µ –º–∞–∫–µ—Ç–∞
- `layout_type`: –¢–∏–ø –º–∞–∫–µ—Ç–∞
- `page_width`: –®–∏—Ä–∏–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–º–º)
- `page_height`: –í—ã—Å–æ—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–º–º)
- `margin_*`: –û—Ç—Å—Ç—É–ø—ã (–º–º)
- `elements`: –≠–ª–µ–º–µ–Ω—Ç—ã –º–∞–∫–µ—Ç–∞

### PrintQueue
- `id`: –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- `job_id`: ID –∑–∞–¥–∞–Ω–∏—è –ø–µ—á–∞—Ç–∏
- `priority`: –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç (1-5)
- `scheduled_at`: –í—Ä–µ–º—è –ø–ª–∞–Ω–∏—Ä—É–µ–º–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- `is_processing`: –í –æ–±—Ä–∞–±–æ—Ç–∫–µ
- `worker_id`: ID –≤–æ—Ä–∫–µ—Ä–∞
- `attempts`: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫

## üîÑ –°—Ç–∞—Ç—É—Å—ã –∑–∞–¥–∞–Ω–∏–π –ø–µ—á–∞—Ç–∏

- `pending`: –û–∂–∏–¥–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏
- `processing`: –í –æ–±—Ä–∞–±–æ—Ç–∫–µ
- `completed`: –ó–∞–≤–µ—Ä—à–µ–Ω–æ
- `failed`: –ù–µ—É–¥–∞—á–Ω–æ
- `cancelled`: –û—Ç–º–µ–Ω–µ–Ω–æ

## üìÑ –§–æ—Ä–º–∞—Ç—ã –ø–µ—á–∞—Ç–∏

- `pdf`: PDF –¥–æ–∫—É–º–µ–Ω—Ç
- `png`: PNG –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
- `jpg`: JPEG –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
- `svg`: SVG –≤–µ–∫—Ç–æ—Ä–Ω–∞—è –≥—Ä–∞—Ñ–∏–∫–∞

## üé® –ü—Ä–∏–º–µ—Ä—ã —à–∞–±–ª–æ–Ω–æ–≤

### QR –≠—Ç–∏–∫–µ—Ç–∫–∞
```html
<!DOCTYPE html>
<html>
<head>
    <title>{{title}}</title>
</head>
<body>
    <div class="qr-label">
        <h1>{{title}}</h1>
        <div class="qr-code">
            <img src="{{qr_code_url}}" alt="QR Code" />
        </div>
        <p class="description">{{description}}</p>
    </div>
</body>
</html>
```

### –û–±–ª–æ–∂–∫–∞ –∞–ª—å–±–æ–º–∞
```html
<!DOCTYPE html>
<html>
<head>
    <title>{{title}}</title>
</head>
<body>
    <div class="album-cover">
        <div class="cover-image">
            <img src="{{cover_image}}" alt="Album Cover" />
        </div>
        <div class="cover-text">
            <h1>{{title}}</h1>
            <h2>{{subtitle}}</h2>
        </div>
    </div>
</body>
</html>
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
pytest

# –ó–∞–ø—É—Å–∫ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
pytest --cov=app
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### Health Check
- `GET /api/v1/health` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞
- `GET /api/v1/health/db` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- `GET /api/v1/print/stats` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–µ—á–∞—Ç–∏
- `GET /api/v1/templates/stats` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —à–∞–±–ª–æ–Ω–æ–≤
- `GET /api/v1/layouts/stats` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –º–∞–∫–µ—Ç–æ–≤
- `GET /api/v1/queue/status` - –°—Ç–∞—Ç—É—Å –æ—á–µ—Ä–µ–¥–∏

## üîÆ –ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è

- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º WeasyPrint
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —à—Ä–∏—Ñ—Ç–æ–≤ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- [ ] –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä —à–∞–±–ª–æ–Ω–æ–≤
- [ ] –ú–∞—Å—Å–æ–≤–∞—è –ø–µ—á–∞—Ç—å
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø—Ä–∏–Ω—Ç–µ—Ä–∞–º–∏
- [ ] –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- [ ] API –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- [ ] –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤
- [ ] –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

1. –§–æ—Ä–∫–Ω–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –°–æ–∑–¥–∞–π—Ç–µ –≤–µ—Ç–∫—É –¥–ª—è –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
3. –í–Ω–µ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
4. –î–æ–±–∞–≤—å—Ç–µ —Ç–µ—Å—Ç—ã
5. –°–æ–∑–¥–∞–π—Ç–µ Pull Request

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License
